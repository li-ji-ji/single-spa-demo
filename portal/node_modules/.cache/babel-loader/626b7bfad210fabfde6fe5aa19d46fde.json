{"ast":null,"code":"function e(t) {\n  return (e = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n    return typeof e;\n  } : function (e) {\n    return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n  })(t);\n}\n\nfunction t(e, t, n) {\n  return t in e ? Object.defineProperty(e, t, {\n    value: n,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[t] = n, e;\n}\n\nfunction n(e, t) {\n  var n = Object.keys(e);\n\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    t && (o = o.filter(function (t) {\n      return Object.getOwnPropertyDescriptor(e, t).enumerable;\n    })), n.push.apply(n, o);\n  }\n\n  return n;\n}\n\nfunction o(e) {\n  for (var o = 1; o < arguments.length; o++) {\n    var r = null != arguments[o] ? arguments[o] : {};\n    o % 2 ? n(Object(r), !0).forEach(function (n) {\n      t(e, n, r[n]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : n(Object(r)).forEach(function (t) {\n      Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t));\n    });\n  }\n\n  return e;\n}\n\nvar r = null,\n    a = {\n  React: null,\n  ReactDOM: null,\n  rootComponent: null,\n  loadRootComponent: null,\n  renderType: null,\n  errorBoundary: null,\n  errorBoundaryClass: null,\n  domElementGetter: null,\n  parcelCanUpdate: !0,\n  suppressComponentDidCatchWarning: !1,\n  domElements: {}\n};\n\nfunction c(t) {\n  if (\"object\" !== e(t)) throw new Error(\"single-spa-react requires a configuration object\");\n  var n = o(o({}, a), t);\n  if (!n.React) throw new Error(\"single-spa-react must be passed opts.React\");\n  if (!n.ReactDOM) throw new Error(\"single-spa-react must be passed opts.ReactDOM\");\n  if (!n.rootComponent && !n.loadRootComponent) throw new Error(\"single-spa-react must be passed opts.rootComponent or opts.loadRootComponent\");\n  if (n.errorBoundary && \"function\" != typeof n.errorBoundary) throw Error(\"The errorBoundary opt for single-spa-react must either be omitted or be a function that returns React elements\");\n  !r && n.React.createContext && (r = n.React.createContext());\n  var c = {\n    bootstrap: i.bind(null, n),\n    mount: p.bind(null, n),\n    unmount: u.bind(null, n)\n  };\n  return n.parcelCanUpdate && (c.update = l.bind(null, n)), c;\n}\n\nfunction i(e, t) {\n  return e.rootComponent ? Promise.resolve() : e.loadRootComponent(t).then(function (t) {\n    e.rootComponent = t;\n  });\n}\n\nfunction p(e, t) {\n  return new Promise(function (n, o) {\n    e.suppressComponentDidCatchWarning || !function (e) {\n      if (!(e && \"string\" == typeof e.version && e.version.indexOf(\".\") >= 0)) return !1;\n      var t = e.version.slice(0, e.version.indexOf(\".\"));\n\n      try {\n        return Number(t) >= 16;\n      } catch (e) {\n        return !1;\n      }\n    }(e.React) || e.errorBoundary || (e.rootComponent.prototype ? e.rootComponent.prototype.componentDidCatch || console.warn(\"single-spa-react: \".concat(t.name || t.appName || t.childAppName, \"'s rootComponent should implement componentDidCatch to avoid accidentally unmounting the entire single-spa application.\")) : console.warn(\"single-spa-react: \".concat(t.name || t.appName || t.childAppName, \"'s rootComponent does not implement an error boundary.  If using a functional component, consider providing an opts.errorBoundary to singleSpaReact(opts).\")));\n\n    var r = function (e, t) {\n      return t.domElement ? function () {\n        return t.domElement;\n      } : t.domElementGetter ? t.domElementGetter : e.domElementGetter ? e.domElementGetter : function (e) {\n        var t = e.appName || e.name;\n        if (!t) throw Error(\"single-spa-react was not given an application name as a prop, so it can't make a unique dom element container for the react application\");\n        var n = \"single-spa-application:\".concat(t);\n        return function () {\n          var e = document.getElementById(n);\n          return e || ((e = document.createElement(\"div\")).id = n, document.body.appendChild(e)), e;\n        };\n      }(t);\n    }(e, t);\n\n    if (\"function\" != typeof r) throw new Error(\"single-spa-react: the domElementGetter for react application '\".concat(t.appName || t.name, \"' is not a function\"));\n\n    var a = m(e, t),\n        c = function (e, t) {\n      var n = e(t);\n      if (!n) throw new Error(\"single-spa-react: domElementGetter function for application '\".concat(t.appName || t.name, \"' did not return a valid dom element. Please pass a valid domElement or domElementGetter via opts or props\"));\n      return n;\n    }(r, t);\n\n    s({\n      elementToRender: a,\n      domElement: c,\n      whenFinished: function () {\n        n(this);\n      },\n      opts: e\n    }), e.domElements[t.name] = c;\n  });\n}\n\nfunction u(e, t) {\n  return Promise.resolve().then(function () {\n    e.ReactDOM.unmountComponentAtNode(e.domElements[t.name]), delete e.domElements[t.name];\n  });\n}\n\nfunction l(e, t) {\n  return new Promise(function (n, o) {\n    s({\n      elementToRender: m(e, t),\n      domElement: e.domElements[t.name],\n      whenFinished: function () {\n        n(this);\n      },\n      opts: e\n    });\n  });\n}\n\nfunction s(e) {\n  var t = e.opts,\n      n = e.elementToRender,\n      o = e.domElement,\n      r = e.whenFinished;\n  return [\"createRoot\", \"unstable_createRoot\", \"createBlockingRoot\", \"unstable_createBlockingRoot\"].indexOf(t.renderType) >= 0 ? t.ReactDOM[t.renderType](o).render(n, r) : \"hydrate\" === t.renderType ? t.ReactDOM.hydrate(n, o, r) : t.ReactDOM.render(n, o, r);\n}\n\nfunction m(e, t) {\n  var n = e.React.createElement(e.rootComponent, t),\n      o = r ? e.React.createElement(r.Provider, {\n    value: t\n  }, n) : n;\n  return e.errorBoundary && (e.errorBoundaryClass = e.errorBoundaryClass || function (e) {\n    function t(n) {\n      e.React.Component.apply(this, arguments), this.state = {\n        caughtError: null,\n        caughtErrorInfo: null\n      }, t.displayName = \"SingleSpaReactErrorBoundary(\".concat(n.name, \")\");\n    }\n\n    return t.prototype = Object.create(e.React.Component.prototype), t.prototype.render = function () {\n      return this.state.caughtError ? e.errorBoundary(this.state.caughtError, this.state.caughtErrorInfo, this.props) : this.props.children;\n    }, t.prototype.componentDidCatch = function (e, t) {\n      this.setState({\n        caughtError: e,\n        caughtErrorInfo: t\n      });\n    }, t;\n  }(e), o = e.React.createElement(e.errorBoundaryClass, t, o)), o;\n}\n\nexport default c;\nexport { r as SingleSpaContext };","map":{"version":3,"sources":["../../src/single-spa-react.js"],"names":["SingleSpaContext","defaultOpts","React","ReactDOM","rootComponent","loadRootComponent","renderType","errorBoundary","errorBoundaryClass","domElementGetter","parcelCanUpdate","suppressComponentDidCatchWarning","domElements","singleSpaReact","userOpts","_typeof","Error","opts","createContext","lifecycles","bootstrap","bind","mount","unmount","update","props","Promise","resolve","then","resolvedComponent","reject","atLeastReact16","prototype","console","warn","name","appName","childAppName","componentDidCatch","chooseDomElementGetter","this","elementToRender","getElementToRender","domElement","getRootDomEl","reactDomRender","whenFinished","unmountComponentAtNode","el","version","indexOf","majorVersionString","slice","Number","err","defaultDomElementGetter","htmlId","document","getElementById","createElement","id","body","appendChild","render","hydrate","rootComponentElement","Provider","value","createErrorBoundary","SingleSpaReactErrorBoundary","Component","apply","arguments","state","caughtError","caughtErrorInfo","displayName","Object","create","children","info","setState"],"mappings":"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","sourcesContent":["/* We don't import parcel.component.js from this file intentionally. See comment\n * in that file for why\n */\n\n// React context that gives any react component the single-spa props\nexport let SingleSpaContext = null;\n\nconst defaultOpts = {\n  // required opts\n  React: null,\n  ReactDOM: null,\n\n  // required - one or the other\n  rootComponent: null,\n  loadRootComponent: null,\n\n  // optional opts\n  renderType: null,\n  errorBoundary: null,\n  errorBoundaryClass: null,\n  domElementGetter: null,\n  parcelCanUpdate: true, // by default, allow parcels created with single-spa-react to be updated\n  suppressComponentDidCatchWarning: false,\n  domElements: {},\n};\n\nexport default function singleSpaReact(userOpts) {\n  if (typeof userOpts !== \"object\") {\n    throw new Error(`single-spa-react requires a configuration object`);\n  }\n\n  const opts = {\n    ...defaultOpts,\n    ...userOpts,\n  };\n\n  if (!opts.React) {\n    throw new Error(`single-spa-react must be passed opts.React`);\n  }\n\n  if (!opts.ReactDOM) {\n    throw new Error(`single-spa-react must be passed opts.ReactDOM`);\n  }\n\n  if (!opts.rootComponent && !opts.loadRootComponent) {\n    throw new Error(\n      `single-spa-react must be passed opts.rootComponent or opts.loadRootComponent`\n    );\n  }\n\n  if (opts.errorBoundary && typeof opts.errorBoundary !== \"function\") {\n    throw Error(\n      `The errorBoundary opt for single-spa-react must either be omitted or be a function that returns React elements`\n    );\n  }\n\n  if (!SingleSpaContext && opts.React.createContext) {\n    SingleSpaContext = opts.React.createContext();\n  }\n\n  const lifecycles = {\n    bootstrap: bootstrap.bind(null, opts),\n    mount: mount.bind(null, opts),\n    unmount: unmount.bind(null, opts),\n  };\n\n  if (opts.parcelCanUpdate) {\n    lifecycles.update = update.bind(null, opts);\n  }\n\n  return lifecycles;\n}\n\nfunction bootstrap(opts, props) {\n  if (opts.rootComponent) {\n    // This is a class or stateless function component\n    return Promise.resolve();\n  } else {\n    // They passed a promise that resolves with the react component. Wait for it to resolve before mounting\n    return opts.loadRootComponent(props).then((resolvedComponent) => {\n      opts.rootComponent = resolvedComponent;\n    });\n  }\n}\n\nfunction mount(opts, props) {\n  return new Promise((resolve, reject) => {\n    if (\n      !opts.suppressComponentDidCatchWarning &&\n      atLeastReact16(opts.React) &&\n      !opts.errorBoundary\n    ) {\n      if (!opts.rootComponent.prototype) {\n        console.warn(\n          `single-spa-react: ${\n            props.name || props.appName || props.childAppName\n          }'s rootComponent does not implement an error boundary.  If using a functional component, consider providing an opts.errorBoundary to singleSpaReact(opts).`\n        );\n      } else if (!opts.rootComponent.prototype.componentDidCatch) {\n        console.warn(\n          `single-spa-react: ${\n            props.name || props.appName || props.childAppName\n          }'s rootComponent should implement componentDidCatch to avoid accidentally unmounting the entire single-spa application.`\n        );\n      }\n    }\n\n    const domElementGetter = chooseDomElementGetter(opts, props);\n\n    if (typeof domElementGetter !== \"function\") {\n      throw new Error(\n        `single-spa-react: the domElementGetter for react application '${\n          props.appName || props.name\n        }' is not a function`\n      );\n    }\n\n    const whenFinished = function () {\n      resolve(this);\n    };\n\n    const elementToRender = getElementToRender(opts, props);\n    const domElement = getRootDomEl(domElementGetter, props);\n    const renderedComponent = reactDomRender({\n      elementToRender,\n      domElement,\n      whenFinished,\n      opts,\n    });\n    opts.domElements[props.name] = domElement;\n  });\n}\n\nfunction unmount(opts, props) {\n  return Promise.resolve().then(() => {\n    opts.ReactDOM.unmountComponentAtNode(opts.domElements[props.name]);\n    delete opts.domElements[props.name];\n  });\n}\n\nfunction update(opts, props) {\n  return new Promise((resolve, reject) => {\n    const whenFinished = function () {\n      resolve(this);\n    };\n\n    const elementToRender = getElementToRender(opts, props);\n    const renderedComponent = reactDomRender({\n      elementToRender,\n      domElement: opts.domElements[props.name],\n      whenFinished,\n      opts,\n    });\n  });\n}\n\nfunction getRootDomEl(domElementGetter, props) {\n  const el = domElementGetter(props);\n  if (!el) {\n    throw new Error(\n      `single-spa-react: domElementGetter function for application '${\n        props.appName || props.name\n      }' did not return a valid dom element. Please pass a valid domElement or domElementGetter via opts or props`\n    );\n  }\n\n  return el;\n}\n\nfunction atLeastReact16(React) {\n  if (\n    React &&\n    typeof React.version === \"string\" &&\n    React.version.indexOf(\".\") >= 0\n  ) {\n    const majorVersionString = React.version.slice(\n      0,\n      React.version.indexOf(\".\")\n    );\n    try {\n      return Number(majorVersionString) >= 16;\n    } catch (err) {\n      return false;\n    }\n  } else {\n    return false;\n  }\n}\n\nfunction chooseDomElementGetter(opts, props) {\n  if (props.domElement) {\n    return () => props.domElement;\n  } else if (props.domElementGetter) {\n    return props.domElementGetter;\n  } else if (opts.domElementGetter) {\n    return opts.domElementGetter;\n  } else {\n    return defaultDomElementGetter(props);\n  }\n}\n\nfunction defaultDomElementGetter(props) {\n  const appName = props.appName || props.name;\n  if (!appName) {\n    throw Error(\n      `single-spa-react was not given an application name as a prop, so it can't make a unique dom element container for the react application`\n    );\n  }\n  const htmlId = `single-spa-application:${appName}`;\n\n  return function defaultDomEl() {\n    let domElement = document.getElementById(htmlId);\n    if (!domElement) {\n      domElement = document.createElement(\"div\");\n      domElement.id = htmlId;\n      document.body.appendChild(domElement);\n    }\n\n    return domElement;\n  };\n}\n\nfunction reactDomRender({ opts, elementToRender, domElement, whenFinished }) {\n  if (\n    [\n      \"createRoot\",\n      \"unstable_createRoot\",\n      \"createBlockingRoot\",\n      \"unstable_createBlockingRoot\",\n    ].indexOf(opts.renderType) >= 0\n  ) {\n    return opts.ReactDOM[opts.renderType](domElement).render(\n      elementToRender,\n      whenFinished\n    );\n  }\n\n  if (opts.renderType === \"hydrate\") {\n    return opts.ReactDOM.hydrate(elementToRender, domElement, whenFinished);\n  }\n\n  // default to this if 'renderType' is null or doesn't match the other options\n  return opts.ReactDOM.render(elementToRender, domElement, whenFinished);\n}\n\nfunction getElementToRender(opts, props) {\n  const rootComponentElement = opts.React.createElement(\n    opts.rootComponent,\n    props\n  );\n\n  let elementToRender = SingleSpaContext\n    ? opts.React.createElement(\n        SingleSpaContext.Provider,\n        { value: props },\n        rootComponentElement\n      )\n    : rootComponentElement;\n\n  if (opts.errorBoundary) {\n    opts.errorBoundaryClass =\n      opts.errorBoundaryClass || createErrorBoundary(opts);\n    elementToRender = opts.React.createElement(\n      opts.errorBoundaryClass,\n      props,\n      elementToRender\n    );\n  }\n\n  return elementToRender;\n}\n\nfunction createErrorBoundary(opts) {\n  // Avoiding babel output for class syntax and super()\n  // to avoid bloat\n  function SingleSpaReactErrorBoundary(props) {\n    // super\n    opts.React.Component.apply(this, arguments);\n\n    this.state = {\n      caughtError: null,\n      caughtErrorInfo: null,\n    };\n\n    SingleSpaReactErrorBoundary.displayName = `SingleSpaReactErrorBoundary(${props.name})`;\n  }\n\n  SingleSpaReactErrorBoundary.prototype = Object.create(\n    opts.React.Component.prototype\n  );\n\n  SingleSpaReactErrorBoundary.prototype.render = function () {\n    if (this.state.caughtError) {\n      return opts.errorBoundary(\n        this.state.caughtError,\n        this.state.caughtErrorInfo,\n        this.props\n      );\n    } else {\n      return this.props.children;\n    }\n  };\n\n  SingleSpaReactErrorBoundary.prototype.componentDidCatch = function (\n    err,\n    info\n  ) {\n    this.setState({\n      caughtError: err,\n      caughtErrorInfo: info,\n    });\n  };\n\n  return SingleSpaReactErrorBoundary;\n}\n"]},"metadata":{},"sourceType":"module"}
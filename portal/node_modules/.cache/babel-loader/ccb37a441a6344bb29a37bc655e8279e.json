{"ast":null,"code":"import * as singleSpa from 'single-spa';\n/**\n * runScript 一个promise同步方法。可以代替创建一个script标签，然后加载服务\n * @param  {string}         url         请求文件地址\n */\n\nconst runScript = async url => {\n  // 加载css同理\n  return new Promise((resolve, reject) => {\n    const script = document.createElement('script');\n    script.src = url;\n    script.onload = resolve;\n    script.onerror = reject;\n    const firstScript = document.getElementsByTagName('script')[0];\n    firstScript.parentNode.insertBefore(script, firstScript);\n  });\n}; // 注册微前端服务\n\n/* \n    注册所用函数;\n    return 一个模块对象（singleSpa），模块对象来自于要加载的js导出（子项目）;\n    如果这个函数不需要在线引入，只需要本地引入一块加载：\n    () => import('xxx/main.js')\n*/\n\n\nsingleSpa.registerApplication({\n  name: 'myApp',\n  app: async () => {\n    await runScript('http://localhost:8081/hzby-app-2.js');\n    return window.singleVue;\n  },\n  activeWhen: ['/myApp', location => location.pathname.startsWith('/myApp')]\n});\nsingleSpa.registerApplication('react', async () => {\n  await runScript('http://localhost:8080/hzby-app-1.js');\n  await runScript('http://localhost:8080/hzby-app-1.js');\n  return window.singleReact;\n}, location => location.pathname.startsWith('/react'));\nsingleSpa.registerApplication('angular', async () => {\n  await runScript('http://localhost:4000/polyfills.js');\n  await runScript('http://localhost:4000/runtime.js');\n  await runScript('http://localhost:4000/styles.js');\n  await runScript('http://localhost:4000/vendor.js');\n  await runScript('http://localhost:4000/main.js');\n  return window.singleAngular;\n}, location => location.pathname.startsWith('/angular'));\nsingleSpa.start(); // 启动","map":{"version":3,"sources":["/home/lhj/learn/code/micro-frontend/single-spa-demo/portal/src/singleSpa.js"],"names":["singleSpa","runScript","url","Promise","resolve","reject","script","document","createElement","src","onload","onerror","firstScript","getElementsByTagName","parentNode","insertBefore","registerApplication","name","app","window","singleVue","activeWhen","location","pathname","startsWith","singleReact","singleAngular","start"],"mappings":"AAAA,OAAO,KAAKA,SAAZ,MAA2B,YAA3B;AAGA;AACA;AACA;AACA;;AACA,MAAMC,SAAS,GAAG,MAAOC,GAAP,IAAe;AAC7B;AACA,SAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,UAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACAF,IAAAA,MAAM,CAACG,GAAP,GAAaP,GAAb;AACAI,IAAAA,MAAM,CAACI,MAAP,GAAgBN,OAAhB;AACAE,IAAAA,MAAM,CAACK,OAAP,GAAiBN,MAAjB;AACA,UAAMO,WAAW,GAAGL,QAAQ,CAACM,oBAAT,CAA8B,QAA9B,EAAwC,CAAxC,CAApB;AACAD,IAAAA,WAAW,CAACE,UAAZ,CAAuBC,YAAvB,CAAoCT,MAApC,EAA4CM,WAA5C;AACH,GAPM,CAAP;AAQH,CAVD,C,CAYA;;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAZ,SAAS,CAACgB,mBAAV,CAA8B;AAC5BC,EAAAA,IAAI,EAAE,OADsB;AAE5BC,EAAAA,GAAG,EAAE,YAAW;AAAC,UAAMjB,SAAS,CAAC,qCAAD,CAAf;AAAuD,WAAOkB,MAAM,CAACC,SAAd;AAAwB,GAFpE;AAG5BC,EAAAA,UAAU,EAAE,CAAC,QAAD,EAAYC,QAAD,IAAcA,QAAQ,CAACC,QAAT,CAAkBC,UAAlB,CAA6B,QAA7B,CAAzB;AAHgB,CAA9B;AAMAxB,SAAS,CAACgB,mBAAV,CACI,OADJ,EAEI,YAAY;AACJ,QAAMf,SAAS,CAAC,qCAAD,CAAf;AACA,QAAMA,SAAS,CAAC,qCAAD,CAAf;AACA,SAAOkB,MAAM,CAACM,WAAd;AACH,CANT,EAOSH,QAAD,IAAcA,QAAQ,CAACC,QAAT,CAAkBC,UAAlB,CAA6B,QAA7B,CAPtB;AAUAxB,SAAS,CAACgB,mBAAV,CACI,SADJ,EAEI,YAAY;AACJ,QAAMf,SAAS,CAAC,oCAAD,CAAf;AACA,QAAMA,SAAS,CAAC,kCAAD,CAAf;AACA,QAAMA,SAAS,CAAC,iCAAD,CAAf;AACA,QAAMA,SAAS,CAAC,iCAAD,CAAf;AACA,QAAMA,SAAS,CAAC,+BAAD,CAAf;AACA,SAAOkB,MAAM,CAACO,aAAd;AACH,CATT,EAUSJ,QAAD,IAAcA,QAAQ,CAACC,QAAT,CAAkBC,UAAlB,CAA6B,UAA7B,CAVtB;AAaAxB,SAAS,CAAC2B,KAAV,G,CAAmB","sourcesContent":["import * as singleSpa from 'single-spa';\n\n\n/**\n * runScript 一个promise同步方法。可以代替创建一个script标签，然后加载服务\n * @param  {string}         url         请求文件地址\n */\nconst runScript = async (url) => {\n    // 加载css同理\n    return new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.src = url;\n        script.onload = resolve;\n        script.onerror = reject;\n        const firstScript = document.getElementsByTagName('script')[0];\n        firstScript.parentNode.insertBefore(script, firstScript);\n    });\n};\n\n// 注册微前端服务\n/* \n    注册所用函数;\n    return 一个模块对象（singleSpa），模块对象来自于要加载的js导出（子项目）;\n    如果这个函数不需要在线引入，只需要本地引入一块加载：\n    () => import('xxx/main.js')\n*/\nsingleSpa.registerApplication({\n  name: 'myApp',\n  app: async() => {await runScript('http://localhost:8081/hzby-app-2.js');return window.singleVue},\n  activeWhen: ['/myApp', (location) => location.pathname.startsWith('/myApp')],\n});\n\nsingleSpa.registerApplication(\n    'react',\n    async () => {\n            await runScript('http://localhost:8080/hzby-app-1.js');\n            await runScript('http://localhost:8080/hzby-app-1.js');\n            return window.singleReact\n        },\n        (location) => location.pathname.startsWith('/react')\n);\n\nsingleSpa.registerApplication(\n    'angular',\n    async () => {\n            await runScript('http://localhost:4000/polyfills.js');\n            await runScript('http://localhost:4000/runtime.js');\n            await runScript('http://localhost:4000/styles.js');\n            await runScript('http://localhost:4000/vendor.js');\n            await runScript('http://localhost:4000/main.js');\n            return window.singleAngular\n        },\n        (location) => location.pathname.startsWith('/angular'),\n);\n\nsingleSpa.start(); // 启动"]},"metadata":{},"sourceType":"module"}